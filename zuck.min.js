/* zuck.js - https://github.com/ramon82/zuck.js */
window.ZuckitaDaGalera=window.Zuck=function(t,A){var u=document,d=this;"string"==typeof t&&(t=u.getElementById(t));var m=function(a){return u.querySelectorAll(a)[0]},e=function(a,b){return a?a[b]||"":""},v=function(a,b){if(a)for(var c=a.length,f=0;f<c;f++)b(f,a[f])},B=function(a,b,c){b=[b.toLowerCase(),"webkit"+b,"MS"+b,"o"+b];v(b,function(b,d){a[d]=c})},L=function(a,b,c){c=[c.toLowerCase(),"webkit"+c,"MS"+c,"o"+c];v(c,function(c,d){a.addEventListener(d,b,!1)})},M=function(a,b){L(a,b,"AnimationEnd")},
R=function(a,b){a.transitionEndEvent||(a.transitionEndEvent=!0,L(a,b,"TransitionEnd"))},D=function(a,b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)},N=function(a,b){var c=b?"ExitFullScreen":"RequestFullScreen",f=b?"exitFullScreen":"requestFullScreen";try{if(a[f])a[f]();else if(a["ms"+c])a["ms"+c]();else if(a.mozCancelFullScreen)a.mozCancelFullScreen();else if(a["webkit"+c])a["webkit"+c]()}catch(q){}},C=function(a,b,c,f){a&&(B(a.style,"TransitionTimingFunction",f),B(a.style,"TransitionDuration",
c+"ms"),B(a.style,"Transform","translate3d("+b+", 0, 0)"))},E=function(a,b,c,f){var d=0,g=0;if(a){if(a.offsetParent){do if(d+=a.offsetLeft,g+=a.offsetTop,a==f)break;while(a=a.offsetParent)}b&&(g-=b);c&&(d-=c)}return[d,g]},F=function(a){a=Number(a);var b=k("language","time"),c=[[60,b.seconds,1],[120,"1"+b.minute,""],[3600,b.minutes,60],[7200,"1"+b.hour,""],[86400,b.hours,3600],[172800,b.yesterday,""],[604800,b.days,86400]],f=(""+a).replace(/-/g,"/").replace(/[TZ]/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,
"");"."==f.substr(f.length-4,1)&&(f=f.substr(0,f.length-4));isNaN((new Date(f)).getDate())&&(f=a);a=(new Date-new Date(f))/1E3;var d=b.ago,g=1;0>a&&(a=Math.abs(a),d=b.ago,g=2);for(var b=0,h;h=c[b++];)if(a<h[0])return"string"==typeof h[2]?h[g]:Math.floor(a/h[2])+" "+h[1]+" "+d;return f},l=t.id,G={skin:"snapgram",avatars:!0,stories:[],backButton:!0,backNative:!1,autoFullScreen:!1,openEffect:!0,list:!1,localStorage:!0,callbacks:{onOpen:function(a,b){b()},onView:function(a){},onEnd:function(a,b){b()},
onClose:function(a,b){b()},onNextItem:function(a,b,c){c()}},language:{unmute:"Touch to unmute",keyboardTip:"Press space to see next",visitLink:"Visit link",time:{ago:"ago",hour:"hour",hours:"hours",minute:"minute",minutes:"minutes",fromnow:"from now",seconds:"seconds",yesterday:"yesterday",tomorrow:"tomorrow",days:"days"}}},k=function(a,b){var c=function(a){return"undefined"!==typeof a};return b?c(A[a])?c(A[a][b])?A[a][b]:G[a][b]:G[a][b]:c(A[a])?A[a]:G[a]},z=new function(){var a=e("#zuck-modal");
a||(a=u.createElement("div"),a.id="zuck-modal",a.innerHTML='<div id="zuck-modal-content"></div>',a.style.display="none",a.setAttribute("tabIndex","1"),a.onkeyup=function(a){a=a.keyCode;27==a?z.close():13!=a&&32!=a||z.next()},k("openEffect")&&a.classList.add("with-effects"),R(a,function(){a.classList.contains("closed")&&(b.innerHTML="",a.style.display="none",a.classList.remove("closed"),a.classList.remove("animated"))}),u.body.appendChild(a));var b=m("#zuck-modal-content"),c=function(a){var b="",c=
"",g="0",e=m("#zuck-modal-slider-"+l),p={previous:m("#zuck-modal .story-viewer.previous"),next:m("#zuck-modal .story-viewer.next"),viewing:m("#zuck-modal .story-viewer.viewing")};if(!p.previous&&!a||!p.next&&a)return!1;a?(b="next",c="previous"):(b="previous",c="next");g=E(p[b]);g=-1*g[0];C(e,g+"px",300,null);setTimeout(function(){if(""!=b&&p[b]&&""!=c){var a=p[b].getAttribute("data-story-id");d.internalData.currentStory=a;(a=m("#zuck-modal .story-viewer."+c))&&a.parentNode.removeChild(a);p.viewing&&
(p.viewing.classList.add("stopped"),p.viewing.classList.add(c),p.viewing.classList.remove("viewing"));p[b]&&(p[b].classList.remove("stopped"),p[b].classList.remove(b),p[b].classList.add("viewing"))}(a=H(b))&&f(a,b);var a=d.internalData.currentStory,g=m('#zuck-modal [data-story-id="'+a+'"]').querySelectorAll("[data-index].active"),h=g[0].firstElementChild;d.data[a].currentItem=parseInt(g[0].getAttribute("data-index"),10);g[0].innerHTML='<b style="'+h.style.cssText+'"></b>';M(g[0].firstElementChild,
function(){d.nextItem(!1)});C(e,"0px",0,null);I([g[0],g[1]],!0);k("callbacks","onView")(d.internalData.currentStory)},350)},f=function(a,b,c){var g=m("#zuck-modal-slider-"+l),f="",h="",w=e(a,"id"),q=u.createElement("div"),x=e(a,"currentItem")||0,y="";if(m('#zuck-modal .story-viewer[data-story-id="'+w+'"]'))return!1;q.className="slides";v(e(a,"items"),function(b,c){x>b&&(a.items[b].seem=!0,c.seem=!0);var g=e(c,"length"),d=e(c,"linkText"),w=!0===e(c,"seem")?"seem":"",r='data-index="'+b+'" data-item-id="'+
e(c,"id")+'"';x===b&&(y=F(e(c,"time")));h+="<span "+r+' class="'+(x===b?"active":"")+" "+w+'"><b style="animation-duration:'+(""===g?"3":g)+'s"></b></span>';f+='<div data-time="'+e(c,"time")+'" data-type="'+e(c,"type")+'"'+r+' class="item '+w+" "+(x===b?"active":"")+'">'+("video"===e(c,"type")?'<video class="media" muted preload="auto" src="'+e(c,"src")+'" '+e(c,"type")+'></video><b class="tip muted">'+k("language","unmute")+"</b>":'<img class="media" src="'+e(c,"src")+'" '+e(c,"type")+">")+(e(c,
"link")?'<a class="tip link" href="'+e(c,"link")+'" rel="noopener" target="_blank">'+(""==d?k("language","visitLink"):d)+"</a>":"")+"</div>"});q.innerHTML=f;var r=q.querySelector("video"),J=function(a){a.muted?n.classList.add("muted"):n.classList.remove("muted")};r&&(r.onwaiting=function(a){r.paused&&(n.classList.add("paused"),n.classList.add("loading"))},r.onplay=function(){J(r);n.classList.remove("stopped");n.classList.remove("paused");n.classList.remove("loading")},r.onready=r.onload=r.onplaying=
r.oncanplay=function(){J(r);n.classList.remove("loading")},r.onvolumechange=function(){J(r)});var n=u.createElement("div");n.className="story-viewer muted "+b+" "+(c?"":"stopped")+" "+(k("backButton")?"with-back-button":"");n.setAttribute("data-story-id",w);c='<div class="head"><div class="left">'+(k("backButton")?'<a class="back">&lsaquo;</a>':"")+'<u class="img" style="background-image:url('+e(a,"photo")+');"></u><div><strong>'+e(a,"name")+'</strong><span class="time">'+y+'</span></div></div><div class="right"><span class="time">'+
y+'</span><span class="loading"></span><a class="close" tabIndex="2">&times;</a></div></div><div class="slides-pointers"><div>'+h+"</div></div>";n.innerHTML=c;v(n.querySelectorAll(".close, .back"),function(a,b){b.onclick=function(a){a.preventDefault();z.close()}});n.appendChild(q);"viewing"==b&&I(n.querySelectorAll('[data-index="'+x+'"].active'),!1);v(n.querySelectorAll(".slides-pointers [data-index] > b"),function(a,b){M(b,function(){d.nextItem(!1)})});"previous"==b?D(g,n):g.appendChild(n)},q=function(b){var f,
g,e,k,q,l,v=function(c){var d=m("#zuck-modal .viewing");if("A"==c.target.nodeName)return!0;c.preventDefault();c=c.touches?c.touches[0]:c;var h=E(m("#zuck-modal .story-viewer.viewing"));a.slideWidth=m("#zuck-modal .story-viewer").offsetWidth;f=h[0];g={x:c.pageX,y:c.pageY,time:Date.now()};e=void 0;k={};b.addEventListener("mousemove",x);b.addEventListener("mouseup",y);b.addEventListener("mouseleave",y);b.addEventListener("touchmove",x);b.addEventListener("touchend",y);d.classList.add("paused");S();q=
setTimeout(function(){d.classList.add("longPress")},600);l=setTimeout(function(){clearInterval(l);l=!1},250)},x=function(a){var c=a.touches?a.touches[0]:a,d=c.pageX,c=c.pageY;g&&(k={x:d-g.x,y:c-g.y},"undefined"===typeof e&&(e=!!(e||Math.abs(k.x)<Math.abs(k.y))),!e&&g&&(a.preventDefault(),C(b,f+k.x+"px",0,null)))},y=function(h){var w=m("#zuck-modal .viewing");if(k){u.querySelectorAll("#zuck-modal .story-viewer");var n=g?Date.now()-g.time:void 0,n=300>Number(n)&&25<Math.abs(k.x)||Math.abs(k.x)>a.slideWidth/
3,p=0>k.x,r=p?m("#zuck-modal .story-viewer.next"):m("#zuck-modal .story-viewer.previous");e||(!n||p&&!r||!p&&!r?C(b,f,300):c(p,!0));g=void 0;b.removeEventListener("mousemove",x);b.removeEventListener("mouseup",y);b.removeEventListener("mouseleave",y);b.removeEventListener("touchmove",x);b.removeEventListener("touchend",y)}n=d.internalData.currentVideoElement;q&&clearInterval(q);w.classList.remove("longPress");w.classList.remove("paused");if(l)if(clearInterval(l),l=!1,w.classList.contains("muted")&&
n)O(n,w);else return d.nextItem(h),!1};b.addEventListener("touchstart",v);b.addEventListener("mousedown",v)};return{show:function(c,e){k("callbacks","onOpen")(c,function(){b.innerHTML='<div id="zuck-modal-slider-'+l+'" class="slider"></div>';var g=d.data[c],e=g.currentItem||0,h=m("#zuck-modal-slider-"+l);q(h);d.internalData.currentStory=c;g.currentItem=e;k("backNative")&&(location.hash="#!"+l);(e=H("previous"))&&f(e,"previous");f(g,"viewing",!0);(g=H("next"))&&f(g,"next");k("autoFullScreen")&&a.classList.add("fullscreen");
var p=function(){a.classList.contains("fullscreen")&&k("autoFullScreen")&&1024>=window.screen.width&&N(a);a.focus()};k("openEffect")?(g=m("#"+l+' [data-id="'+c+'"] .img'),e=E(g),a.style.marginLeft=e[0]+g.offsetWidth/2+"px",a.style.marginTop=e[1]+g.offsetHeight/2+"px",a.style.display="block",setTimeout(function(){a.classList.add("animated")},10),setTimeout(function(){p()},300)):(a.style.display="block",p());k("callbacks","onView")(c)})},next:function(a){k("callbacks","onEnd")(d.internalData.currentStory,
function(){var a=d.internalData.currentStory,b=m("#"+l+' [data-id="'+a+'"]');b&&(b.classList.add("seem"),d.data[a].seem=!0,d.internalData.seemItems[a]=!0,P("seemItems",d.internalData.seemItems),K());m("#zuck-modal .story-viewer.next")?c(!0):z.close()})},close:function(){k("callbacks","onClose")(d.internalData.currentStory,function(){k("backNative")&&(location.hash="");N(a,!0);k("openEffect")?a.classList.add("closed"):(b.innerHTML="",a.style.display="none")})}}},T=function(a){a=a.getAttribute("data-id");
var b=u.querySelectorAll("#"+l+' [data-id="'+a+'"] .items > li'),c=[];v(b,function(a,b){var d=b.firstElementChild,f=d.firstElementChild;c.push({src:d.getAttribute("href"),length:d.getAttribute("data-length"),type:d.getAttribute("data-type"),time:d.getAttribute("data-time"),link:d.getAttribute("data-link"),preview:f.getAttribute("src")})});d.data[a].items=c},Q=function(a){var b=a.getAttribute("data-id"),c=!1;d.internalData.seemItems[b]&&(c=!0);c?a.classList.add("seem"):a.classList.remove("seem");try{d.data[b]=
{id:b,photo:a.getAttribute("data-photo"),name:a.firstElementChild.lastElementChild.firstChild.innerText,link:a.firstElementChild.getAttribute("href"),lastUpdated:a.getAttribute("data-last-updated"),seem:c,items:[]}}catch(f){d.data[b]={items:[]}}a.onclick=function(a){a.preventDefault();z.show(b)}},H=function(a){var b=d.internalData.currentStory;a+="ElementSibling";return b&&(b=m("#"+l+' [data-id="'+b+'"]')[a])?(b=b.getAttribute("data-id"),d.data[b]||!1):!1},K=function(){v(u.querySelectorAll("#"+l+
" .story.seem"),function(a,b){var c=d.data[b.getAttribute("data-id")];b.parentNode.removeChild(b);d.add(c,!0)})},I=function(a,b){var c=a[1],f=a[0],e=f.parentNode.parentNode.parentNode;if(!c||!f)return!1;var g=d.internalData.currentVideoElement;g&&g.pause();if("video"==c.getAttribute("data-type")){var h=c.getElementsByTagName("video")[0];if(!h)return d.internalData.currentVideoElement=!1;c=function(){h.duration&&B(f.getElementsByTagName("b")[0].style,"AnimationDuration",h.duration+"s")};c();h.addEventListener("loadedmetadata",
c);d.internalData.currentVideoElement=h;h.currentTime=0;h.play();b.target&&O(h,e)}else d.internalData.currentVideoElement=!1},S=function(){var a=d.internalData.currentVideoElement;if(a)try{a.pause()}catch(b){}},O=function(a,b){a.muted=!1;a.volume=1;a.removeAttribute("muted");a.play();a.paused&&(a.muted=!0,a.play());b&&b.classList.remove("paused")},P=function(a,b){k("localStorage")&&(window.localStorage["zuck-"+l+"-"+a]=JSON.stringify(b))};d.data={};d.internalData={};d.internalData.seemItems=function(a){return k("localStorage")?
(a="zuck-"+l+"-"+a,window.localStorage[a]?JSON.parse(window.localStorage[a]):!1):!1}("seemItems")||{};d.add=d.update=function(a,b){var c=e(a,"id"),f=m("#"+l+' [data-id="'+c+'"]'),q="",g=e(a,"items"),h=!1;d.data[c]={};f?h=f:(h=u.createElement("div"),h.className="story");!1===a.seem&&(d.internalData.seemItems[c]=!1,P("seemItems",d.internalData.seemItems));h.setAttribute("data-id",c);h.setAttribute("data-photo",e(a,"photo"));h.setAttribute("data-last-updated",e(a,"lastUpdated"));q=!1;g[0]&&(q=g[0].preview||
"");q='<a href="'+e(a,"link")+'"><span class="img"><u style="background-image:url('+(k("avatars")||!q||""==q?e(a,"photo"):q)+')"></u></span><span class="info"><strong>'+e(a,"name")+'</strong><span class="time">'+F(e(a,"lastUpdated"))+'</span></span></a><ul class="items"></ul>';h.innerHTML=q;Q(h);f||(b?t.appendChild(h):D(t,h));v(g,function(a,f){d.addItem(c,f,b)});b||K()};d.next=function(){z.next()};d.addItem=function(a,b,c){a=m("#"+l+' > [data-id="'+a+'"]');var d=u.createElement("li");d.className=
e(b,"seem")?"seem":"";d.setAttribute("data-id",e(b,"id"));d.innerHTML='<a href="'+e(b,"src")+'" data-link="'+e(b,"link")+'" data-time="'+e(b,"time")+'" data-type="'+e(b,"type")+'" data-length="'+e(b,"length")+'"><img src="'+e(b,"preview")+'"></a>';b=a.querySelectorAll(".items")[0];c?b.appendChild(d):D(b,d);T(a)};d.removeItem=function(a,b){var c=m("#"+l+' > [data-id="'+a+'"] [data-id="'+b+'"]');t.parentNode.removeChild(c)};d.nextItem=function(a){var b=d.internalData.currentStory,c=d.data[b].currentItem,
f=m('#zuck-modal .story-viewer[data-story-id="'+b+'"]');if(!f||1==f.touchMove)return!1;var e=f.querySelectorAll('[data-index="'+c+'"]'),g=e[0],h=e[1],l=f.querySelectorAll('[data-index="'+(c+1)+'"]'),u=l[0],t=l[1];f&&u&&t?k("callbacks","onNextItem")(b,t.getAttribute("data-story-id"),function(){g.classList.remove("active");g.classList.add("seem");h.classList.remove("active");h.classList.add("seem");u.classList.remove("seem");u.classList.add("active");t.classList.remove("seem");t.classList.add("active");
v(f.querySelectorAll(".time"),function(a,b){b.innerText=F(t.getAttribute("data-time"))});d.data[b].currentItem++;I(l,a)}):f&&z.next(a)};return function(){location.hash=="#!"+l&&(location.hash="");m("#"+l+" .story")&&v(t.querySelectorAll(".story"),function(a,b){Q(b,!0)});k("backNative")&&window.addEventListener("popstate",function(a){location.hash!="#!"+l&&(location.hash="")},!1);v(k("stories"),function(a,b){d.add(b,!0)});K();var a=k("avatars")?"user-icon":"story-preview",b=k("list")?"list":"carousel";
t.className="stories "+a+" "+b+" "+(k("skin")+"").toLowerCase();return d}()};