/* zuck.js - https://github.com/ramon82/zuck.js */
window.ZuckitaDaGalera=window.Zuck=function(p,t){var u=document,c=this;"string"==typeof p&&(p=u.getElementById(p));var q=function(a){return u.querySelectorAll(a)[0]},d=function(a,b){return a?a[b]||"":""},w=function(a,b){if(a)for(var f=a.length,k=0;k<f;k++)b(k,a[k])},A=function(a,b,f){b=[b.toLowerCase(),"webkit"+b,"MS"+b,"o"+b];w(b,function(b,c){a[c]=f})},G=function(a,b,f){f=[f.toLowerCase(),"webkit"+f,"MS"+f,"o"+f];w(f,function(f,c){a.addEventListener(c,b,!1)})},H=function(a,b){G(a,b,"AnimationEnd")},
I=function(a,b){a.transitionEndEvent||(a.transitionEndEvent=!0,G(a,b,"TransitionEnd"))},B=function(a,b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)},J=function(a,b){var f=b?"ExitFullScreen":"RequestFullScreen",k=b?"exitFullScreen":"requestFullScreen";try{if(a[k])a[k]();else if(a["ms"+f])a["ms"+f]();else if(a.mozCancelFullScreen)a.mozCancelFullScreen();else if(a["webkit"+f])a["webkit"+f]()}catch(r){}},N=function(a,b,f,k){var c=0,m=0;if(a){if(a.offsetParent){do if(c+=a.offsetLeft,m+=
a.offsetTop,a==k)break;while(a=a.offsetParent)}b&&(m-=b);f&&(c-=f)}return[c,m]},C=function(a){a=Number(a);var b=l("language","time"),f=[[60,b.seconds,1],[120,"1"+b.minute,""],[3600,b.minutes,60],[7200,"1"+b.hour,""],[86400,b.hours,3600],[172800,b.yesterday,""],[604800,b.days,86400]],c=(""+a).replace(/-/g,"/").replace(/[TZ]/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"");"."==c.substr(c.length-4,1)&&(c=c.substr(0,c.length-4));isNaN((new Date(c)).getDate())&&(c=a);a=(new Date-new Date(c))/1E3;var d=
b.ago,m=1;0>a&&(a=Math.abs(a),d=b.ago,m=2);for(var b=0,e;e=f[b++];)if(a<e[0])return"string"==typeof e[2]?e[m]:Math.floor(a/e[2])+" "+e[1]+" "+d;return c},n=p.id,y={skin:"snapgram",avatars:!0,stories:[],backButton:!0,backNative:!1,autoFullScreen:!1,openEffect:!0,list:!1,localStorage:!0,callbacks:{onOpen:function(a,b){b()},onView:function(a){},onEnd:function(a,b){b()},onClose:function(a,b){b()},onNextItem:function(a,b,c){c()}},language:{unmute:"Touch to unmute",keyboardTip:"Press space to see next",
visitLink:"Visit link",time:{ago:"ago",hour:"hour",hours:"hours",minute:"minute",minutes:"minutes",fromnow:"from now",seconds:"seconds",yesterday:"yesterday",tomorrow:"tomorrow",days:"days"}}},l=function(a,b){var c=function(a){return"undefined"!==typeof a};return b?c(t[a])?c(t[a][b])?t[a][b]:y[a][b]:y[a][b]:c(t[a])?t[a]:y[a]},z=new function(){var a=d("#zuck-modal");a||(a=u.createElement("div"),a.id="zuck-modal",a.innerHTML='<div id="zuck-modal-content"></div>',a.style.display="none",a.setAttribute("tabIndex",
"1"),a.onkeyup=function(a){a=a.keyCode;27==a?z.close():13!=a&&32!=a||z.next()},l("openEffect")&&a.classList.add("with-effects"),I(a,function(){a.classList.contains("closed")&&(b.innerHTML="",a.style.display="none",a.classList.remove("closed"),a.classList.remove("animated"))}),u.body.appendChild(a));var b=q("#zuck-modal-content"),f=function(a,f){var e="",m="",d="translate3d(0,0,0)";if(!a.previous&&-1==a.direction||!a.next&&1==a.direction)return b.classList.add("animated"),A(b.style,"Transform",d),
!1;-1===a.direction?(e="previous",m="next",d="translate3d(100vw,0,0)"):1===a.direction&&(e="next",m="previous",d="translate3d(-100vw,0,0)");b.classList.add("animated");A(b.style,"Transform",d);setTimeout(function(){b.classList.remove("animated");if(""!=e&&a[e]&&""!=m){var d=a[e].getAttribute("data-story-id");c.internalData.currentStory=d;(d=q("#zuck-modal .story-viewer."+m))&&d.parentNode.removeChild(d);a.viewing&&(a.viewing.classList.add("stopped"),a.viewing.classList.add(m),a.viewing.classList.remove("viewing"));
a[e]&&(a[e].classList.remove("stopped"),a[e].classList.remove(e),a[e].classList.add("viewing"));a=k(a)}(d=D(e))&&r(d,e);var d=c.internalData.currentStory,g=q('#zuck-modal [data-story-id="'+d+'"]').querySelectorAll("[data-index].active"),x=g[0].firstElementChild;c.data[d].currentItem=parseInt(g[0].getAttribute("data-index"),10);g[0].innerHTML='<b style="'+x.style.cssText+'"></b>';H(g[0].firstElementChild,function(){c.nextItem(!1)});E([g[0],g[1]],f);b.style.transform="translate3d(0,0,0)";l("callbacks",
"onView")(c.internalData.currentStory);I(b,function(){b.classList.remove("animated")})},250)},k=function(a){var b;a:{for(b=q("#zuck-modal .story-viewer.viewing");b.previousElementSibling;){b=1;break a}b=0}a.index=b;a.previous=q("#zuck-modal .story-viewer.previous");a.viewing=q("#zuck-modal .story-viewer.viewing");a.next=q("#zuck-modal .story-viewer.next");a.slideWidth=q("#zuck-modal .story-viewer").offsetWidth;return a},r=function(a,e,x){var m="",r="",n=d(a,"id"),g=u.createElement("div"),p=d(a,"currentItem")||
0,t="";if(q('#zuck-modal .story-viewer[data-story-id="'+n+'"]'))return!1;g.className="slides";w(d(a,"items"),function(b,c){p>b&&(a.items[b].seem=!0,c.seem=!0);var e=d(c,"length"),f=d(c,"linkText"),g=!0===d(c,"seem")?"seem":"",k='data-index="'+b+'" data-item-id="'+d(c,"id")+'"';p===b&&(t=C(d(c,"time")));r+="<span "+k+' class="'+(p===b?"active":"")+" "+g+'"><b style="animation-duration:'+(""===e?"3":e)+'s"></b></span>';m+='<div data-time="'+d(c,"time")+'" data-type="'+d(c,"type")+'"'+k+' class="item '+
g+" "+(p===b?"active":"")+'">'+("video"===d(c,"type")?'<video class="media" muted preload="auto" src="'+d(c,"src")+'" '+d(c,"type")+'></video><b class="tip muted">'+l("language","unmute")+"</b>":'<img class="media" src="'+d(c,"src")+'" '+d(c,"type")+">")+(d(c,"link")?'<a class="tip link" href="'+d(c,"link")+'" rel="noopener" target="_blank">'+(""==f?l("language","visitLink"):f)+"</a>":"")+"</div>"});g.innerHTML=m;var v=g.querySelector("video"),y=function(a){a.muted?h.classList.add("muted"):h.classList.remove("muted")};
v&&(v.onwaiting=function(a){v.paused&&(h.classList.add("paused"),h.classList.add("loading"))},v.onplay=function(){y(v);h.classList.remove("stopped");h.classList.remove("paused");h.classList.remove("loading")},v.onready=v.onload=v.onplaying=v.oncanplay=function(){y(v);h.classList.remove("loading")},v.onvolumechange=function(){y(v)});var h=u.createElement("div");h.className="story-viewer muted "+e+" "+(x?"":"stopped")+" "+(l("backButton")?"with-back-button":"");h.setAttribute("data-story-id",n);x='<div class="head"><div class="left">'+
(l("backButton")?'<a class="back">&lsaquo;</a>':"")+'<u class="img" style="background-image:url('+d(a,"photo")+');"></u><div><strong>'+d(a,"name")+'</strong><span class="time">'+t+'</span></div></div><div class="right"><span class="time">'+t+'</span><span class="loading"></span><a class="close" tabIndex="2">&times;</a></div></div><div class="slides-pointers"><div>'+r+"</div></div>";h.innerHTML=x;w(h.querySelectorAll(".close, .back"),function(a,b){b.onclick=function(a){a.preventDefault();z.close()}});
x=function(a){if("A"==a.target.nodeName)return!0;a.preventDefault();a.touches&&(g.touchStartX=a.touches[0].pageX);g.slideWidth=q("#zuck-modal .story-viewer").offsetWidth;g=k(g);h.touchMove=0;h.classList.add("paused");O();h.timer=setTimeout(function(){h.classList.add("longPress")},600);h.nextTimer=setTimeout(function(){clearInterval(h.nextTimer);h.nextTimer=!1},250)};n=function(a){if("A"==a.target.nodeName)return!0;a.preventDefault();var e=c.internalData.currentVideoElement;h.timer&&clearInterval(h.timer);
h.classList.remove("longPress");h.classList.remove("paused");if(h.nextTimer)if(clearInterval(h.nextTimer),h.nextTimer=!1,h.classList.contains("muted")&&e)K(e,h);else return c.nextItem(a),!1;h.touchMove=0;g.touchStartX=0;g.moveX?(e=Math.abs(g.index*g.slideWidth-g.moveX),g.direction=0,e>g.slideWidth/2&&(g.moveX>g.index*g.slideWidth&&2>g.index?(g.index++,g.direction=1):g.moveX<g.index*g.slideWidth&&0<g.index&&(g.index--,g.direction=-1)),f(g,a,"nextTouch"),h.classList.remove("longPress")):A(b.style,"Transform",
"translate3d(0,0,0)")};h.addEventListener("touchstart",x);h.addEventListener("touchmove",function(a){a.preventDefault();if(h.next)return!1;var c=g.touchStartX-g.touchMoveX;h.touchMove=1;g.touchMoveX=a.touches[0].pageX;g.moveX=g.slideWidth+c;g.moveX=c>=g.slideWidth?g.slideWidth:g.moveX;A(b.style,"Transform","translate3d("+(-1*g.moveX+g.slideWidth)+"px,0,0)");b.classList.remove("animated")});h.addEventListener("touchend",n);g.addEventListener("mousedown",x);g.addEventListener("mouseup",n);h.appendChild(g);
"viewing"==e&&E(h.querySelectorAll('[data-index="'+p+'"].active'),!1);w(h.querySelectorAll(".slides-pointers [data-index] > b"),function(a,b){H(b,function(){c.nextItem(!1)})});"previous"==e?B(b,h):b.appendChild(h)};return{show:function(f,e){l("callbacks","onOpen")(f,function(){var e=c.data[f],d=e.currentItem||0;c.internalData.currentStory=f;e.currentItem=d;l("backNative")&&(location.hash="#!"+n);(d=D("previous"))&&r(d,"previous");r(e,"viewing",!0);(e=D("next"))&&r(e,"next");A(b.style,"Transform",
"");l("autoFullScreen")&&a.classList.add("fullscreen");var k=function(){a.classList.contains("fullscreen")&&l("autoFullScreen")&&1024>=window.screen.width&&J(a);a.focus()};l("openEffect")?(e=q("#"+n+' [data-id="'+f+'"] .img'),d=N(e),a.style.marginLeft=d[0]+e.offsetWidth/2+"px",a.style.marginTop=d[1]+e.offsetHeight/2+"px",a.style.display="block",setTimeout(function(){a.classList.add("animated")},10),setTimeout(function(){k()},300)):(a.style.display="block",k());l("callbacks","onView")(f)})},next:function(a){l("callbacks",
"onEnd")(c.internalData.currentStory,function(){var b=c.internalData.currentStory,d=q("#"+n+' [data-id="'+b+'"]');d&&(d.classList.add("seem"),c.data[b].seem=!0,c.internalData.seemItems[b]=!0,L("seemItems",c.internalData.seemItems),F());b=q('#zuck-modal .story-viewer[data-story-id="'+b+'"] .slides');b=k(b);b.direction=1;b.index++;b.next?f(b,a,"nextModal"):z.close()})},close:function(){l("callbacks","onClose")(c.internalData.currentStory,function(){l("backNative")&&(location.hash="");J(a,!0);l("openEffect")?
a.classList.add("closed"):(b.innerHTML="",a.style.display="none")})}}},P=function(a){a=a.getAttribute("data-id");var b=u.querySelectorAll("#"+n+' [data-id="'+a+'"] .items > li'),f=[];w(b,function(a,b){var c=b.firstElementChild,e=c.firstElementChild;f.push({src:c.getAttribute("href"),length:c.getAttribute("data-length"),type:c.getAttribute("data-type"),time:c.getAttribute("data-time"),link:c.getAttribute("data-link"),preview:e.getAttribute("src")})});c.data[a].items=f},M=function(a){var b=a.getAttribute("data-id"),
f=!1;c.internalData.seemItems[b]&&(f=!0);f?a.classList.add("seem"):a.classList.remove("seem");try{c.data[b]={id:b,photo:a.getAttribute("data-photo"),name:a.firstElementChild.lastElementChild.firstChild.innerText,link:a.firstElementChild.getAttribute("href"),lastUpdated:a.getAttribute("data-last-updated"),seem:f,items:[]}}catch(k){c.data[b]={items:[]}}a.onclick=function(a){a.preventDefault();z.show(b)}},D=function(a){var b=c.internalData.currentStory;a+="ElementSibling";return b&&(b=q("#"+n+' [data-id="'+
b+'"]')[a])?(b=b.getAttribute("data-id"),a=c.data[b]||!1,1==d(c.data[b],"seem")?!1:a):!1},F=function(){w(u.querySelectorAll("#"+n+" .story.seem"),function(a,b){var f=c.data[b.getAttribute("data-id")];b.parentNode.removeChild(b);c.add(f,!0)})},E=function(a,b){var f=a[1],d=a[0],l=d.parentNode.parentNode.parentNode;if(!f||!d)return!1;var m=c.internalData.currentVideoElement;m&&m.pause();if("video"==f.getAttribute("data-type")){var e=f.getElementsByTagName("video")[0];if(!e)return c.internalData.currentVideoElement=
!1;f=function(){e.duration&&A(d.getElementsByTagName("b")[0].style,"AnimationDuration",e.duration+"s")};f();e.addEventListener("loadedmetadata",f);c.internalData.currentVideoElement=e;e.currentTime=0;e.play();b.target&&K(e,l)}else c.internalData.currentVideoElement=!1},O=function(){var a=c.internalData.currentVideoElement;if(a)try{a.pause()}catch(b){}},K=function(a,b){a.muted=!1;a.volume=1;a.removeAttribute("muted");a.play();a.paused&&(a.muted=!0,a.play());b&&b.classList.remove("paused")},L=function(a,
b){if(l("localStorage")){var c="zuck-"+n+"-"+a;console.log("saveLocalData",b);window.localStorage[c]=JSON.stringify(b)}};c.data={};c.internalData={};c.internalData.seemItems=function(a){return l("localStorage")?(a="zuck-"+n+"-"+a,window.localStorage[a]?JSON.parse(window.localStorage[a]):!1):!1}("seemItems")||{};c.add=c.update=function(a,b){var f=d(a,"id"),k=q("#"+n+' [data-id="'+f+'"]'),r="",m=d(a,"items"),e=!1;c.data[f]={};k?e=k:(e=u.createElement("div"),e.className="story");!1===a.seem&&(c.internalData.seemItems[f]=
!1,L("seemItems",c.internalData.seemItems));e.setAttribute("data-id",f);e.setAttribute("data-photo",d(a,"photo"));e.setAttribute("data-last-updated",d(a,"lastUpdated"));r=!1;m[0]&&(r=m[0].preview||"");r='<a href="'+d(a,"link")+'"><span class="img"><u style="background-image:url('+(l("avatars")||!r||""==r?d(a,"photo"):r)+')"></u></span><span class="info"><strong>'+d(a,"name")+'</strong><span class="time">'+C(d(a,"lastUpdated"))+'</span></span></a><ul class="items"></ul>';e.innerHTML=r;M(e);k||(b?p.appendChild(e):
B(p,e));w(m,function(a,d){c.addItem(f,d,b)});b||F()};c.next=function(){z.next()};c.addItem=function(a,b,c){a=q("#"+n+' > [data-id="'+a+'"]');var f=u.createElement("li");f.className=d(b,"seem")?"seem":"";f.setAttribute("data-id",d(b,"id"));f.innerHTML='<a href="'+d(b,"src")+'" data-link="'+d(b,"link")+'" data-time="'+d(b,"time")+'" data-type="'+d(b,"type")+'" data-length="'+d(b,"length")+'"><img src="'+d(b,"preview")+'"></a>';b=a.querySelectorAll(".items")[0];c?b.appendChild(f):B(b,f);P(a)};c.removeItem=
function(a,b){var c=q("#"+n+' > [data-id="'+a+'"] [data-id="'+b+'"]');p.parentNode.removeChild(c)};c.nextItem=function(a){var b=c.internalData.currentStory,d=c.data[b].currentItem,k=q('#zuck-modal .story-viewer[data-story-id="'+b+'"]');if(!k||1==k.touchMove)return!1;var n=k.querySelectorAll('[data-index="'+d+'"]'),m=n[0],e=n[1],p=k.querySelectorAll('[data-index="'+(d+1)+'"]'),u=p[0],t=p[1];k&&u&&t?l("callbacks","onNextItem")(b,t.getAttribute("data-story-id"),function(){m.classList.remove("active");
m.classList.add("seem");e.classList.remove("active");e.classList.add("seem");u.classList.remove("seem");u.classList.add("active");t.classList.remove("seem");t.classList.add("active");w(k.querySelectorAll(".time"),function(a,b){b.innerText=C(t.getAttribute("data-time"))});c.data[b].currentItem++;E(p,a)}):k&&z.next(a)};return function(){location.hash=="#!"+n&&(location.hash="");q("#"+n+" .story")&&w(p.querySelectorAll(".story"),function(a,b){M(b,!0)});l("backNative")&&window.addEventListener("popstate",
function(a){location.hash!="#!"+n&&(location.hash="")},!1);w(l("stories"),function(a,b){c.add(b,!0)});F();var a=l("avatars")?"user-icon":"story-preview",b=l("list")?"list":"carousel";p.className="stories "+a+" "+b+" "+(l("skin")+"").toLowerCase();return c}()};